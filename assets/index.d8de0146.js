var e=Object.defineProperty,t=Object.getOwnPropertySymbols,r=Object.prototype.hasOwnProperty,a=Object.prototype.propertyIsEnumerable,n=(t,r,a)=>r in t?e(t,r,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[r]=a,s=(e,s)=>{for(var c in s||(s={}))r.call(s,c)&&n(e,c,s[c]);if(t)for(var c of t(s))a.call(s,c)&&n(e,c,s[c]);return e};import{e as c,r as o,C as u,R as i,l,c as d,a as h}from"./vendor.6a853802.js";const m=new window.AudioContext;var p="_page_1wv6c_1",f="_operationWrapper_1wv6c_4",y="_audioWrapper_1wv6c_10",g="_exampleWrapper_1wv6c_14",x="_footer_1wv6c_22",v="_github_1wv6c_35";const{transform:E}=c;function w(e,{x:t,y:r,r:a,shadowColor:n}){const c=n?{shadowColor:n,shadowBlur:16}:{};e.addShape("circle",{attrs:s({x:t,y:r,r:a,fill:"#262626"},c)});const o=e.addShape("image",{id:"audioImg",attrs:{x:t-a,y:r-a,width:2*a,height:2*a,img:`https://howdz.deno.dev/unsplash/random?keyword=Nature&${2*a}x${2*a}`}});o.setClip({type:"circle",attrs:{x:t,y:r,r:a}});const u=o.getMatrix(),i=2*Math.PI;return o.animate((e=>({matrix:E(u,[["t",-t,-r],["r",i*e],["t",t,r]])})),{duration:1e4,repeat:!0}),setTimeout((()=>{o.pauseAnimate()})),o}const P=150,M=150,I=80;function S(e,t,r,a){o.exports.useEffect((()=>{setTimeout((()=>{var e,a;r?null==(e=t.current)||e.resumeAnimate():null==(a=t.current)||a.pauseAnimate()}))}),[r]),o.exports.useEffect((()=>{var t;const r=null==(t=e.current)?void 0:t.findById("audioImg");r&&r.attr("img",a)}),[a])}function R(e){const t="#e9dcf7",r=o.exports.useRef(),a=o.exports.useRef(),n=o.exports.useRef([]);return o.exports.useEffect((()=>{var t;if(null==(t=e.data)?void 0:t.length){(function(e){return e.reduce(((e,t,r)=>(r%2&&e.push(t),e)),[])})(e.data).map(((e,t)=>{n.current[t].attr("height",e*e/65025*50+4)}))}}),[e.data]),o.exports.useEffect((()=>{r.current=new u({container:"SLine",width:300,height:300}),a.current=w(r.current,{x:P,y:M,r:I,shadowColor:t}),n.current=Array.from({length:64},((e,a)=>{const n=5.625*a-150,s=Math.cos(n*Math.PI/180),c=Math.sin(n*Math.PI/180);return r.current.addShape("rect",{attrs:{width:4,height:4,radius:2,x:P+90*s-2,y:M+90*c-2,fill:t}}).rotateAtPoint(P+90*s,M+90*c,(n-90)*Math.PI/180)}))}),[]),S(r,a,e.isPlaying,e.audioImg),i.createElement("div",{className:"s-model"},i.createElement("div",{id:"SLine",className:"s-canvas-wrapper"}))}function A(e,t=5,r=.8){if(t<3||t>13||t%2==0)throw new Error("num value muse be singular, num >= 3, num <= 13");return e.map(((a,n)=>{const s=(t-1)/2-n%t,c=e[n+s];return~~(c?c*r**Math.abs(s):a)}))}function N(e,t){"#"===e[0]&&(e=e.slice(1));const r=parseInt(e,16);return`rgba(${r>>16}, ${255&r}, ${r>>8&255}, ${t})`}function C(e){const t=["#e9dcf7","#cdd9f5","#cdf5dd","#f3dfbb"],r=o.exports.useRef(),a=o.exports.useRef(),n=o.exports.useRef([]);function s(e,t=0){const r=5.625*e-150,a=Math.cos(r*Math.PI/180),n=Math.sin(r*Math.PI/180),s=84+t;return[P+a*s,M+n*s]}return o.exports.useEffect((()=>{var t;if(null==(t=e.data)?void 0:t.length){const t=[[],[],[],[]];(function(e){let t=[];return e.map(((e,r)=>{r%2&&t.push(e)})),A(t,5,.75)})(e.data).map(((e,r)=>{t[r%4].push(s(r,e*e/65025*30+4))})),t.map(((e,t)=>{var r;const a=l().x((e=>e[0])).y((e=>e[1])).curve(d)(e);null==(r=n.current[t])||r.attr("path",a)}))}}),[e.data]),o.exports.useEffect((()=>{r.current=new u({container:"SPath",width:300,height:300}),a.current=w(r.current,{x:P,y:M,r:I,shadowColor:t[0]});const e=Array.from({length:16},((e,t)=>s(4*t))),c=l().x((e=>e[0])).y((e=>e[1])).curve(d)(e);Array.from({length:4},((e,a)=>{n.current.push(r.current.addShape("path",{attrs:{stroke:t[a],lineWidth:1,path:c}}))}))}),[]),S(r,a,e.isPlaying,e.audioImg),i.createElement("div",{className:"s-model"},i.createElement("div",{id:"SPath",className:"s-canvas-wrapper"}))}function b(e){const t=128,r="#e9dcf7",a=o.exports.useRef(),n=o.exports.useRef(),s=o.exports.useRef([]),c=o.exports.useRef();function h(e,t=0){const r=2.8125*e-150,a=Math.cos(r*Math.PI/180),n=Math.sin(r*Math.PI/180),s=90+t;return[P+a*s,M+n*s,a,n]}return o.exports.useEffect((()=>{var r;if((null==(r=e.data)?void 0:r.length)&&c.current){const r=e.data.reduce(((e,t,r)=>r%8?[...e,h(r,t*t/65025*36+4)]:e),[]),a=l().x((e=>e[0])).y((e=>e[1])).curve(d)(r);c.current.attr("path",a),s.current.map(((e,r)=>{const{x:a,y:n}=c.current.getPoint(r/t);e.attr("x",a),e.attr("y",n)}))}}),[e.data]),o.exports.useEffect((()=>{a.current=new u({container:"SPathDot",width:300,height:300}),n.current=w(a.current,{x:P,y:M,r:I,shadowColor:r});const e=Array.from({length:16},((e,t)=>h(8*t))),o=l().x((e=>e[0])).y((e=>e[1])).curve(d)(e);c.current=a.current.addShape("path",{attrs:{lineWidth:1,path:o}}),s.current=Array.from({length:t},((e,n)=>{const{x:s,y:o}=c.current.getPoint(n/t),[,,u,i]=h(n),l=5*u,d=5*i;return a.current.addShape("circle",{attrs:{x:s,y:o,r:1.2,fill:r,shadowColor:"#22aaff",shadowOffsetX:-l,shadowOffsetY:-d,shadowBlur:4}})}))}),[]),S(a,n,e.isPlaying,e.audioImg),i.createElement("div",{className:"s-model"},i.createElement("div",{id:"SPathDot",className:"s-canvas-wrapper"}))}function _(e){const t=["#81D8F2","#67A1E0","#5263C2","#74E1A5"],r=o.exports.useRef(),a=o.exports.useRef(),n=o.exports.useRef([]);function s(e,t=0){const r=5.625*e-150,a=Math.cos(r*Math.PI/180),n=Math.sin(r*Math.PI/180),s=I+t;return[P+a*s,M+n*s]}return o.exports.useEffect((()=>{var t;if(null==(t=e.data)?void 0:t.length){const t=[[],[],[],[]];(function(e){let t=[];return e.map(((e,r)=>{r%2&&t.push(e)})),A(t,5,.75)})(e.data).map(((e,r)=>{t[r%4].push(s(r,e*e/65025*60))})),t.map(((e,t)=>{const r=l().x((e=>e[0])).y((e=>e[1])).curve(d)(e);n.current[t].attr("path",r)}))}}),[e.data]),o.exports.useEffect((()=>{r.current=new u({container:"SPathFill",width:300,height:300}),a.current=w(r.current,{x:P,y:M,r:I,shadowColor:"#ffffff"}).setZIndex(2);const e=Array.from({length:16},((e,t)=>s(4*t))),c=l().x((e=>e[0])).y((e=>e[1])).curve(d)(e);Array.from({length:4},((e,a)=>{n.current.push(r.current.addShape("path",{attrs:{stroke:t[a],lineWidth:1,path:c,fill:N(t[a],.2)}}).setZIndex(1))}))}),[]),S(r,a,e.isPlaying,e.audioImg),i.createElement("div",{className:"s-model"},i.createElement("div",{id:"SPathFill",className:"s-canvas-wrapper"}))}function k(e){const t="#fff",r=o.exports.useRef(),a=o.exports.useRef(),n=o.exports.useRef([]),s=o.exports.useRef([]),c=o.exports.useRef([]),l=o.exports.useRef([]),d=o.exports.useRef([]),h=o.exports.useRef(!1);return o.exports.useEffect((()=>{d.current=e.data||[]}),[e.data]),o.exports.useEffect((()=>{if(!r.current){r.current=new u({container:"SCircle",width:300,height:300}),a.current=w(r.current,{x:P,y:M,r:I,shadowColor:"#fcc8d9"});const o=()=>r.current.addShape("circle",{attrs:{stroke:t,lineWidth:2,opacity:0,x:P,y:M,r:I}}),i=()=>r.current.addShape("circle",{attrs:{x:P,y:70,r:5,fill:t,shadowColor:"#e9dcf7",shadowBlur:5,opacity:0}}),h={duration:6e3,easing:"easeLinear",repeat:!0};Array.from({length:3},((t,r)=>{l.current.push(!1),n.current.push(o()),n.current[r].animate((e=>({r:I+80*e,opacity:e>.02&&e<.9?.8-.8*e:0})),h),s.current.push(i()),c.current.push(0),s.current[r].animate((t=>{e.data&&t<.05&&!c.current[r]?c.current[r]=(()=>{const e=d.current||[],t=e.sort(((e,t)=>t-e)).slice(0,10)[~~(10*Math.random())],r=e.findIndex((e=>e===t));return~r?360*r/e.length:1})():t>.9&&(c.current[r]=0);const a=c.current[r]+360*t-180,n=Math.cos(a*Math.PI/180),s=Math.sin(a*Math.PI/180),o=I+80*t;return{x:P+n*o,y:M+s*o,r:5*(1-t/2),opacity:t>.05&&t<.9?.8-.8*t:0}}),h)}))}if(e.isPlaying)for(let e=0;e<n.current.length;e++)l.current[e]?(n.current[e].resumeAnimate(),s.current[e].resumeAnimate()):setTimeout((()=>{h.current&&(n.current[e].resumeAnimate(),s.current[e].resumeAnimate(),l.current[e]=!0)}),2e3*e);else setTimeout((()=>{for(let e=0;e<n.current.length;e++)n.current[e].pauseAnimate(),s.current[e].pauseAnimate()}))}),[e.isPlaying]),o.exports.useEffect((()=>{h.current=e.isPlaying}),[e.isPlaying]),S(r,a,e.isPlaying,e.audioImg),i.createElement("div",{className:"s-model"},i.createElement("div",{id:"SCircle",className:"s-canvas-wrapper"}))}function $(e){const t="#e9dcf7",r=o.exports.useRef(),a=o.exports.useRef(),n=o.exports.useRef(),s=o.exports.useRef([]);function c(e,t=0){const r=5.625*e-150,a=Math.cos(r*Math.PI/180),n=Math.sin(r*Math.PI/180),s=90+t;return[P+a*s,M+n*s]}return o.exports.useEffect((()=>{var t,r;if(null==(t=e.data)?void 0:t.length){const t=[],a=function(e){let t=[];return e.map(((e,r)=>{r%2&&t.push(e)})),A(t,3,.5)}(e.data);a.map(((e,r)=>{const n=c(r,e*e/65025*60),o=c(r,-e*e/65025*12);t[r]=n,t[a.length+r]=o,s.current[r].attr("x1",n[0]),s.current[r].attr("y1",n[1]),s.current[r].attr("x2",o[0]),s.current[r].attr("y2",o[1])}));const o=l().x((e=>e[0])).y((e=>e[1])).curve(d)(t);null==(r=n.current)||r.attr("path",o)}}),[e.data]),o.exports.useEffect((()=>{var e,c,o;r.current=new u({container:"SPathDouble",width:300,height:300}),a.current=w(r.current,{x:P,y:M,r:I,shadowColor:t}),n.current=r.current.addShape("path",{attrs:{stroke:t,lineWidth:1,path:(e=P,c=M,o=90,`M ${e-o}, ${c}\n  a ${o}, ${o} 0 1, 0 ${2*o}, 0 \n  a ${o}, ${o} 0 1, 0 ${2*-o}, 0`)}}),s.current=Array.from({length:64},((e,a)=>r.current.addShape("line",{attrs:{x1:P,y1:70,x2:P,y2:70,stroke:t,lineWidth:1}})))}),[]),S(r,a,e.isPlaying,e.audioImg),i.createElement("div",{className:"s-model"},i.createElement("div",{id:"SPathDouble",className:"s-canvas-wrapper"}))}function O(e){const t="#e9dcf7",r=o.exports.useRef(),a=o.exports.useRef(),n=o.exports.useRef([]),s=o.exports.useRef([]);function c(e,t=0){const r=5.625*e-150,a=Math.cos(r*Math.PI/180),n=Math.sin(r*Math.PI/180),s=90+t;return[P+a*s,M+n*s,a,n]}return o.exports.useEffect((()=>{var t,r;(null==(t=e.data)?void 0:t.length)&&(r=e.data,r.reduce(((e,t,r)=>r%2?[...e,t]:e),[])).map(((e,t)=>{const[r,a]=c(t,e*e/65025*24+4);n.current[t].attr("x",r),n.current[t].attr("y",a),s.current[t].attr("x2",r),s.current[t].attr("y2",a)}))}),[e.data]),o.exports.useEffect((()=>{r.current=new u({container:"SDot",width:300,height:300}),a.current=w(r.current,{x:P,y:M,r:I,shadowColor:t}),Array.from({length:64},((e,a)=>{const[o,u,i,l]=c(a),d=~~(5.625*a+210),h=r.current.addShape("circle",{attrs:{x:o,y:u,r:2,fill:t}}),m=r.current.addShape("line",{attrs:{x1:o,y1:u,x2:o,y2:u,lineWidth:2.8,stroke:`l(${d}) 0.3:rgba(255,255,255,0) 1:#e9dcf7`}});n.current.push(h),s.current.push(m)}))}),[]),S(r,a,e.isPlaying,e.audioImg),i.createElement("div",{className:"s-model"},i.createElement("div",{id:"SDot",className:"s-canvas-wrapper"}))}function W(e){const t=o.exports.useRef(),r=o.exports.useRef(),a=o.exports.useRef([]),n=o.exports.useRef([]),s=o.exports.useRef([]),c=o.exports.useRef(-1),l=o.exports.useRef(),d=o.exports.useRef(!1);return o.exports.useEffect((()=>{if(e.isPlaying&&e.data&&e.data.length){if(l.current)return;l.current=setTimeout((()=>{const t=e.data?e.data.reduce(((e,t,r)=>r%2?[...e,t]:e),[]):[],r=t.sort(((e,t)=>t-e)).slice(0,10)[~~(10*Math.random())],a=t.findIndex((e=>e===r));c.current=a,l.current=0,clearTimeout(l.current)}),300)}}),[e.isPlaying,e.data]),o.exports.useEffect((()=>{t.current||(t.current=new u({container:"SParticle",width:300,height:300}),r.current=w(t.current,{x:P,y:M,r:I,shadowColor:"#fcc8d9"}),Array.from({length:64},((e,r)=>{Array.from({length:12},((e,o)=>{const u=5.625*r-150+10*(Math.random()-.5),i=Math.cos(u*Math.PI/180),l=Math.sin(u*Math.PI/180),d=P+80*i,h=M+80*l,m=t.current.addShape("circle",{attrs:{x:d,y:h,r:.8,fill:"#fff",opacity:0}});m.animate((e=>{const t=5.625*r-150+4*Math.sin(20*e),a=Math.cos(t*Math.PI/180),n=Math.sin(t*Math.PI/180),u=64*r+o;s.current[u]&&(e<.02?s.current[u]=r>=c.current-1&&r<=c.current+1?48:18:e>.98&&(s.current[u]=18));const i=s.current[u]||18;return{x:d+a*e*i,y:h+n*e*i,opacity:1-e}}),{duration:4e3,repeat:!0,easing:"easeSinInOut"}),a.current.push(m),n.current.push(!1),s.current.push(18)}))}))),e.isPlaying?a.current.map(((e,t)=>{n.current[t]?e.resumeAnimate():setTimeout((()=>{d.current&&(e.resumeAnimate(),n.current[t]=!0)}),4e3*Math.random())})):setTimeout((()=>{a.current.map((e=>{e.pauseAnimate()}))}))}),[e.isPlaying]),o.exports.useEffect((()=>{d.current=e.isPlaying}),[e.isPlaying]),S(t,r,e.isPlaying,e.audioImg),i.createElement("div",{className:"s-model"},i.createElement("div",{id:"SParticle",className:"s-canvas-wrapper"}))}const j=new class{constructor(e){this.options=s(s({},{size:128}),e),this.analyser=m.createAnalyser(),this.analyser.fftSize=2*this.options.size,this.gainNode=m.createGain(),this.gainNode.connect(m.destination),this.analyser.connect(this.gainNode),this.options.audioEl&&(this.audioSource=m.createMediaElementSource(this.options.audioEl),this.audioSource.connect(this.analyser)),this.visualArr=new Uint8Array(this.analyser.frequencyBinCount),this.resumeAudioContext()}resumeAudioContext(){if(m){const e=()=>{"suspended"===m.state&&m.resume(),document.removeEventListener("click",e)};document.addEventListener("click",e)}}destory(){var e;this.analyser.disconnect(this.gainNode),null==(e=this.audioSource)||e.disconnect(this.analyser),this.gainNode.disconnect(m.destination)}setAudioEl(e){this.audioSource&&this.audioSource.disconnect(this.analyser),this.audioSource=m.createMediaElementSource(e),this.audioSource.connect(this.analyser)}changeVolumn(e){this.gainNode.gain.value=e}getVisualizeValue(){return this.analyser.getByteFrequencyData(this.visualArr),this.visualArr}};function D(){const e=o.exports.useRef(null);o.exports.useEffect((()=>{j.setAudioEl(e.current)}),[]);const[t,r]=o.exports.useState("Please load a music..."),[a,n]=o.exports.useState(),[s,c]=o.exports.useState([]),[u,l]=o.exports.useState(),[d,h]=o.exports.useState(!1),m=o.exports.useRef(null);let E,w=o.exports.useRef();function P(e){E||(E=e);const t=e-E;(0===t||t>0)&&(c([...j.getVisualizeValue()]),E=e),w.current=requestAnimationFrame(P)}function M(){h(!1),w.current&&cancelAnimationFrame(w.current)}return i.createElement(i.Fragment,null,i.createElement("main",{className:p},i.createElement("div",{className:f},i.createElement("button",{className:"btn m10",onClick:async function(){var t;try{const e=encodeURIComponent("https://api.wqwlkj.cn/wqwlapi/wyy_random.php?type=json"),t=await fetch(`https://kongfandong.cn/api/transfer?target=${e}`,{headers:{"content-type":"application/json; charset=utf-8"}}),{data:a}=await t.json();console.log("data",a);const{name:s,url:c,artistsname:o,picurl:u}=a;r(`${s} - ${o}`),n(c),l(u),M()}catch(a){console.error(a),null==(t=e.current)||t.pause(),M(),alert("API busy...")}}},"Random an online music"),i.createElement("button",{className:"btn m10",onClick:function(){var e;null==(e=m.current)||e.click()}},"Choose a local muisc"),i.createElement("div",{className:"strong-text m10",style:{minWidth:"200px"}},t),i.createElement("input",{type:"file",style:{display:"none"},ref:m,onChange:function(e){const t=e.target.files[0],a=URL.createObjectURL(t);r(t.name),n(a)}})),i.createElement("div",{className:y},i.createElement("audio",{controls:!0,onPlay:function(){h(!0),w.current=requestAnimationFrame(P)},onPause:M,ref:e,src:a,crossOrigin:"anonymous"})),i.createElement("div",{className:g},i.createElement(R,{isPlaying:d,data:s,audioImg:u}),i.createElement($,{isPlaying:d,data:s,audioImg:u}),i.createElement(C,{isPlaying:d,data:s,audioImg:u}),i.createElement(_,{isPlaying:d,data:s,audioImg:u}),i.createElement(k,{isPlaying:d,data:s,audioImg:u}),i.createElement(W,{isPlaying:d,data:s,audioImg:u}),i.createElement(O,{isPlaying:d,data:s,audioImg:u}),i.createElement(b,{isPlaying:d,data:s,audioImg:u}),Array.from({length:5}).map(((e,t)=>i.createElement("div",{key:t,className:"s-module-fake"}))))),i.createElement("footer",{className:x},"Â©",i.createElement("a",{href:"mailto://kfd_personal@163.com"},"Leon.D"),i.createElement("a",{className:v,href:"https://github.com/leon-kfd/g-music-visualizer",target:"_blank"},i.createElement("svg",{viewBox:"0 0 1024 1024",width:"20",height:"20"},i.createElement("path",{d:"M960 512c0 97.76-28.704 185.216-85.664 263.264-56.96 78.016-130.496 131.84-220.64 161.856-10.304 1.824-18.368 0.448-22.848-4.032a22.4 22.4 0 0 1-7.2-17.504v-122.88c0-37.632-10.304-65.44-30.464-82.912a409.856 409.856 0 0 0 59.616-10.368 222.752 222.752 0 0 0 54.72-22.816c18.848-10.784 34.528-23.36 47.104-38.592 12.544-15.232 22.848-35.904 30.912-61.44 8.096-25.568 12.128-54.688 12.128-87.904 0-47.072-15.232-86.976-46.208-120.16 14.368-35.456 13.024-74.912-4.48-118.848-10.752-3.616-26.432-1.344-47.072 6.272s-38.56 16.16-53.824 25.568l-21.984 13.888c-36.32-10.304-73.536-15.232-112.096-15.232s-75.776 4.928-112.096 15.232a444.48 444.48 0 0 0-24.672-15.68c-10.336-6.272-26.464-13.888-48.896-22.432-21.952-8.96-39.008-11.232-50.24-8.064-17.024 43.936-18.368 83.424-4.032 118.848-30.496 33.632-46.176 73.536-46.176 120.608 0 33.216 4.032 62.336 12.128 87.456 8.032 25.12 18.368 45.76 30.496 61.44 12.544 15.68 28.224 28.704 47.072 39.04 18.848 10.304 37.216 17.92 54.72 22.816a409.6 409.6 0 0 0 59.648 10.368c-15.712 13.856-25.12 34.048-28.704 60.064a99.744 99.744 0 0 1-26.464 8.512 178.208 178.208 0 0 1-33.184 2.688c-13.024 0-25.568-4.032-38.144-12.544-12.544-8.512-23.296-20.64-32.256-36.32a97.472 97.472 0 0 0-28.256-30.496c-11.232-8.064-21.088-12.576-28.704-13.92l-11.648-1.792c-8.096 0-13.92 0.928-17.056 2.688-3.136 1.792-4.032 4.032-2.688 6.72s3.136 5.408 5.376 8.096 4.928 4.928 7.616 7.168l4.032 2.688c8.544 4.032 17.056 11.232 25.568 21.984 8.544 10.752 14.368 20.64 18.4 29.6l5.824 13.44c4.928 14.816 13.44 26.912 25.568 35.872 12.096 8.992 25.088 14.816 39.008 17.504 13.888 2.688 27.36 4.032 40.352 4.032s23.776-0.448 32.288-2.24l13.472-2.24c0 14.784 0 32.288 0.416 52.032 0 19.744 0.48 30.496 0.48 31.392a22.624 22.624 0 0 1-7.648 17.472c-4.928 4.48-12.992 5.824-23.296 4.032-90.144-30.048-163.68-83.84-220.64-161.888C92.256 697.216 64 609.312 64 512c0-81.152 20.192-156.064 60.096-224.672s94.176-122.88 163.232-163.232C355.936 84.192 430.816 64 512 64s156.064 20.192 224.672 60.096 122.88 94.176 163.232 163.232C939.808 355.488 960 430.848 960 512",fill:"#585862"})),i.createElement("span",null," Github"))))}function B(){return i.createElement("div",{className:"App"},i.createElement(D,null))}h.render(i.createElement(i.StrictMode,null,i.createElement(B,null)),document.getElementById("root"));
